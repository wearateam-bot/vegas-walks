<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Vegas Walks</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link
  rel="stylesheet"
  href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
/>
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

</head>

<body style="font-family: system-ui; text-align:center;padding:20px;">

<h1>üé∞ Vegas Walks</h1>

<div id="lock">
  <p>This tour unlocks via QR code.</p>
  <button onclick="unlockTour()">Unlock Tour</button>
</div>
<div id="endTour" style="display:none;margin-top:30px;">
  <h2>üéâ End of the Tour</h2>
  <p>
    Thanks for walking Downtown Las Vegas with <b>Vegas Walks</b>.<br>
    If you enjoyed the tour, tips are greatly appreciated and help keep this experience alive.
  </p>

  <div id="paypal-container-7SDB2F6UNJJ2E"></div>
</div>

<script src="https://www.paypal.com/sdk/js?client-id=sb&components=hosted-buttons"></script>
<script>
  paypal.HostedButtons({
    hostedButtonId: "7SDB2F6UNJJ2E",
  }).render("#paypal-container-7SDB2F6UNJJ2E");
</script>
<div id="tour" style="display:none;">

<button onclick="startTour()" style="padding:12px 20px;">Start Tour</button>

<div id="map" style="height:250px;margin:15px 0;"></div>

<div id="content"></div>

<audio id="audio" controls style="margin-top:10px;width:100%;"></audio>

<p id="distance" style="font-size:13px;color:#666;"></p>

<div id="testPanel" style="display:none;">
  <hr>
  <h3>üß™ Test Stops</h3>
  <div id="testButtons"></div>
</div>

</div>

<script>
const isTestMode = window.location.search.includes("test=1");

const stops = [
{
  name:"Sin City Hostel",
  lat:36.15886,lng:-115.14939,radius:350,
  image:"https://upload.wikimedia.org/wikipedia/commons/5/54/Las_Vegas_wedding_chapel_1950s.jpg",
  audio:"https://upload.wikimedia.org/wikipedia/commons/transcoded/4/45/Short_Silence.ogg/Short_Silence.ogg.mp3",
  info:"üíç <b>Wedding Capital of the World</b><br>Vegas became famous for instant marriages after 1931 law changes."
},
{
  name:"El Cortez & Container Park",
  lat:36.1706,lng:-115.1409,radius:350,
  image:"https://upload.wikimedia.org/wikipedia/commons/3/39/El_Cortez_Hotel_1940s.jpg",
  audio:"https://upload.wikimedia.org/wikipedia/commons/transcoded/4/45/Short_Silence.ogg/Short_Silence.ogg.mp3",
  info:"üè® <b>El Cortez</b><br>One of Vegas‚Äô oldest casinos and a symbol of downtown revival."
},
{
  name:"Fremont & Las Vegas Blvd",
  lat:36.1695,lng:-115.1401,radius:350,
  image:"https://upload.wikimedia.org/wikipedia/commons/7/7c/Fremont_Street_1930s.jpg",
  audio:"https://upload.wikimedia.org/wikipedia/commons/transcoded/4/45/Short_Silence.ogg/Short_Silence.ogg.mp3",
  info:"üåµ <b>From desert road to neon icon</b><br>Fremont was the original heart of Las Vegas."
},
{
  name:"Golden Gate",
  lat:36.1702,lng:-115.1441,radius:350,
  image:"https://upload.wikimedia.org/wikipedia/commons/9/9e/Golden_Gate_Hotel_1906.jpg",
  audio:"https://upload.wikimedia.org/wikipedia/commons/transcoded/4/45/Short_Silence.ogg/Short_Silence.ogg.mp3",
  info:"üèõÔ∏è <b>Golden Gate</b><br>The oldest hotel in Las Vegas."
},
{
  name:"Circa & Legacy Club",
  lat:36.1708,lng:-115.1433,radius:350,
  image:"https://upload.wikimedia.org/wikipedia/commons/6/6b/Circa_Resort.jpg",
  audio:"https://upload.wikimedia.org/wikipedia/commons/transcoded/4/45/Short_Silence.ogg/Short_Silence.ogg.mp3",
  info:"üì∫ <b>Circa</b><br>The world‚Äôs largest sportsbook and rooftop history tribute."
},
{
  name:"Binion‚Äôs",
  lat:36.1701,lng:-115.1436,radius:350,
  image:"https://upload.wikimedia.org/wikipedia/commons/2/22/Binions_Horseshoe_1969.jpg",
  audio:"https://upload.wikimedia.org/wikipedia/commons/transcoded/4/45/Short_Silence.ogg/Short_Silence.ogg.mp3",
  info:"‚ô†Ô∏è <b>Binion‚Äôs</b><br>Birthplace of the World Series of Poker."
},
{
  name:"Golden Nugget",
  lat:36.1707,lng:-115.1437,radius:350,
  image:"https://upload.wikimedia.org/wikipedia/commons/8/8a/Golden_Nugget_1950s.jpg",
  audio:"https://upload.wikimedia.org/wikipedia/commons/transcoded/4/45/Short_Silence.ogg/Short_Silence.ogg.mp3",
  info:"ü•á <b>Golden Nugget</b><br>Home of the Hand of Faith gold nugget."
},
{
  name:"Four Queens",
  lat:36.1704,lng:-115.1448,radius:350,
  image:"https://upload.wikimedia.org/wikipedia/commons/5/59/Four_Queens_1960s.jpg",
  audio:"https://upload.wikimedia.org/wikipedia/commons/transcoded/4/45/Short_Silence.ogg/Short_Silence.ogg.mp3",
  info:"üé≤ <b>Four Queens</b><br>Classic Fremont Street gambling."
},
{
  name:"The D & Sigma Derby",
  lat:36.1709,lng:-115.1455,radius:350,
  image:"https://upload.wikimedia.org/wikipedia/commons/3/3f/Sigma_Derby.jpg",
  audio:"https://upload.wikimedia.org/wikipedia/commons/transcoded/4/45/Short_Silence.ogg/Short_Silence.ogg.mp3",
  info:"üêé <b>Sigma Derby</b><br>One of the last mechanical horse racing games."
},
{
  name:"Hammered Harry‚Äôs",
  lat:36.1714,lng:-115.1463,radius:350,
  image:"https://upload.wikimedia.org/wikipedia/commons/4/45/Las_Vegas_Bar_1960s.jpg",
  audio:"https://upload.wikimedia.org/wikipedia/commons/transcoded/4/45/Short_Silence.ogg/Short_Silence.ogg.mp3",
  info:"üçπ <b>Hammered Harry‚Äôs</b><br>Free margarita & half-off apps for tour guests."
}
];

let index=0,map,marker;

function unlockTour(){
  document.getElementById("lock").style.display="none";
  document.getElementById("tour").style.display="block";
  initMap();
  if(isTestMode) document.getElementById("testPanel").style.display="block";
}

function initMap(){
  map=L.map('map').setView([36.1699,-115.1427],15);
  L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png').addTo(map);
  marker=L.marker([0,0]).addTo(map);
}

function startTour(){
  navigator.geolocation.watchPosition(p=>{
    marker.setLatLng([p.coords.latitude,p.coords.longitude]);
    const s=stops[index];
    const d=getDistance(p.coords.latitude,p.coords.longitude,s.lat,s.lng);
    document.getElementById("distance").innerText=`${Math.round(d)} m`;
    if(d<=s.radius) showStop(index++);
  });
}

function showStop(i){
  const s=stops[i];
  document.getElementById("content").innerHTML=
    `<h3>${s.name}</h3><img src="${s.image}" style="width:100%;border-radius:8px;"><p>${s.info}</p>`;
  const a=document.getElementById("audio");
  a.src=s.audio;a.play();
}

function getDistance(a,b,c,d){
  const R=6371000,to=x=>x*Math.PI/180;
  const A=Math.sin(to(c-a)/2)**2+
    Math.cos(to(a))*Math.cos(to(c))*Math.sin(to(d-b)/2)**2;
  return R*2*Math.atan2(Math.sqrt(A),Math.sqrt(1-A));
}

if(isTestMode){
  const tb=document.getElementById("testButtons");
  stops.forEach((s,i)=>{
    const b=document.createElement("button");
    b.innerText=s.name;
    b.onclick=()=>showStop(i);
    tb.appendChild(b);
  });
}
</script>

</body>
</html>